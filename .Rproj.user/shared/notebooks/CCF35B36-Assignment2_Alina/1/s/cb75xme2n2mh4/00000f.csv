"0","# We subset to only include no noise and a specific rate"
"0","d1 <- d %>% "
"0","  subset(noise == 0 & rate == 0.8) %>% "
"0","  rename(Other = choice) %>% "
"0","  mutate(cumulativerate = lag(cumulativerate, 1))"
"0",""
"0","d1$cumulativerate[1] <- 0.5 # no prior info at first trial"
"0","d1$cumulativerate[d1$cumulativerate == 0] <- 0.01"
"0","d1$cumulativerate[d1$cumulativerate == 1] <- 0.99"
"0",""
"0","# Now we create the memory agent with a coefficient of 0.9"
"0","MemoryAgent_f <- function(bias, beta, cumulativerate){"
"0","    choice = rbinom(1, 1, inv_logit_scaled(bias + beta * cumulativerate))"
"0","  return(choice)"
"0","}"
"0",""
"0","d1$Self[1] <- RandomAgentNoise_f(0.5, 0)"
"2","Warning: Unknown or uninitialised column: `Self`."
