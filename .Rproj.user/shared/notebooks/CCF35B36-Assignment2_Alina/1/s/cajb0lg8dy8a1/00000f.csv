"0","## Create the data"
"0","data <- list("
"0","  n = 120,"
"0","  h = d1$Self,"
"0","  other = d1$Other"
"0",")"
"0",""
"0","stan_model <- """
"0","// The input (data) for the model. n of trials and h for (right and left) hand"
"0","data {"
"0"," int<lower=1> n;"
"0"," array[n] int h;"
"0"," array[n] int other;"
"0","}"
"0",""
"0","// The parameters accepted by the model. "
"0","parameters {"
"0","  real bias; // how likely is the agent to pick right when the previous rate has no information (50-50)?"
"0","  real beta; // how strongly is previous rate impacting the decision?"
"0","}"
"0",""
"0","transformed parameters{"
"0","  vector[n] memory;"
"0",""
"0","  for (trial in 1:n){"
"0","  if (trial == 1) {"
"0","    memory[trial] = 0.5;"
"0","  } "
"0","  if (trial < n){"
"0","      memory[trial + 1] = memory[trial] + ((other[trial] - memory[trial]) / trial);"
"0","      if (memory[trial + 1] == 0){memory[trial + 1] = 0.01;}"
"0","      if (memory[trial + 1] == 1){memory[trial + 1] = 0.99;}"
"0","    }"
"0","  }"
"0","}"
"0",""
"0","// The model to be estimated. "
"0","model {"
"0","  // Priors"
"0","  target += normal_lpdf(bias | 0, .3);"
"0","  target += normal_lpdf(beta | 0, .5);"
"0","  "
"0","  // Model, looping to keep track of memory"
"0","  for (trial in 1:n) {"
"0","    target += bernoulli_logit_lpmf(h[trial] | bias + beta * logit(memory[trial]));"
"0","  }"
"0","}"
"0",""
"0",""""
"0","write_stan_file("
"0","  stan_model,"
"0","  dir = ""stan/"","
"0","  basename = ""W3_InternalMemory.stan"")"
"1","[1]"
"1"," ""C:/Users/Kereszt Alina/Documents/GitHub/st8_ACM_assign2/stan/W3_InternalMemory.stan"""
"1","
"
