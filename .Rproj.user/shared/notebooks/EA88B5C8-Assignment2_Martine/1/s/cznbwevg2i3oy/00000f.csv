"0","# Building function for asymmetric win stay loose shift agent by including probabilities for winning and loosing"
"0",""
"0","AsymWSLSAgent_f <- function(prevChoice, Feedback, winProb, lossProb){"
"0","  "
"0","  if (Feedback == 1){"
"0","    "
"0","    randomness <- rbinom(1, 1, winProb)"
"0","    # stay with choice agent would initially have made"
"0","    if (randomness == 1){"
"0","      choice = prevChoice "
"0","    # randomly shift"
"0","    } else if (randomness == 0){"
"0","      choice = 1-prevChoice"
"0","    }"
"0","      "
"0","  } else if (Feedback == 0){"
"0","    "
"0","    randomness <- rbinom(1, 1, lossProb)"
"0","    # stay with choice agent would initially have made"
"0","    if (randomness == 1){"
"0","      choice = 1-prevChoice"
"0","    # randomly shift"
"0","    } else if (randomness == 0){"
"0","      choice = prevChoice"
"0","    }"
"0","  }"
"0","  "
"0","  return(choice)"
"0","}"
"0",""
"0","# empty vectors for agents"
"0","Self <- rep(NA, trials)"
"0","Random <- rep(NA, trials)"
"0","Feedbacklist <- rep(NA, trials)"
"0",""
"0","# other agent's choices"
"0","for (t in seq(trials)){"
"0","  Random[t] <- RandomAgent_f(trials, rate)"
"0","}"
"0",""
"0","# first choice is random..."
"0","Self[1] <- rbinom(1,1,0.5)"
"0",""
"0","# all other choices"
"0","for (t in 2:trials){"
"0","  "
"0","  # get feedback"
"0","  if (Self[t-1] == Random[t-1]){"
"0","    Feedback = 1"
"0","  } else {Feedback = 0}"
"0","  "
"0","  # register feedback"
"0","  Feedbacklist[t-1] <- Feedback"
"0","  "
"0","  # make decision"
"0","  Self[t] <- AsymWSLSAgent_f(Self[t-1], "
"0","                         Feedback,"
"0","                         0.9, #Win probability"
"0","                         0.7) #Loose probability"
"0","}"
"0",""
"0","if (Self[120] == Random[120]){"
"0","    Feedbacklist[120] = 1"
"0","  } else {Feedbacklist[120] = 0}"
"0",""
"0","# turn into tibble"
"0","WSLS_df <- tibble(Self,"
"0","             Random,"
"0","             trial = seq(trials),"
"0","             Feedback_prevT = Feedbacklist)"
"0",""
